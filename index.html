<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ - GitHub Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .section {
            padding: 25px;
            display: block;
        }
        
        .hidden {
            display: none !important;
        }
        
        .login-form {
            text-align: center;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-logout {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .teacher-info {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-right: 5px solid #3498db;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 15px 10px;
            text-align: right;
            font-weight: 600;
            font-size: 14px;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid #ecf0f1;
            text-align: right;
            font-size: 14px;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #666;
        }
        
        .result-cell {
            font-weight: bold;
            text-align: center;
            font-size: 13px;
            padding: 8px 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .result-excellent {
            color: #27ae60;
            background-color: rgba(39, 174, 96, 0.1);
            border-color: rgba(39, 174, 96, 0.3);
        }
        
        .result-good {
            color: #3498db;
            background-color: rgba(52, 152, 219, 0.1);
            border-color: rgba(52, 152, 219, 0.3);
        }
        
        .result-average {
            color: #f39c12;
            background-color: rgba(243, 156, 18, 0.1);
            border-color: rgba(243, 156, 18, 0.3);
        }
        
        .result-poor {
            color: #e74c3c;
            background-color: rgba(231, 76, 60, 0.1);
            border-color: rgba(231, 76, 60, 0.3);
        }
        
        .student-name {
            color: #3498db;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            padding: 5px;
            border-radius: 3px;
            display: inline-block;
        }
        
        .student-name:hover {
            color: #2980b9;
            background-color: rgba(52, 152, 219, 0.1);
            transform: translateY(-1px);
        }
        
        .edit-btn {
            background-color: #f39c12;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s ease;
        }
        
        .edit-btn:hover {
            background-color: #e67e22;
        }
        
        .search-container {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .search-container input,
        .search-container select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            flex: 1;
            min-width: 200px;
        }
        
        .stats-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 5px solid #3498db;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .connection-status {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 2% auto;
            padding: 25px;
            border-radius: 15px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            background: #f0f0f0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .student-form {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .form-section {
            grid-column: 1 / -1;
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 15px;
            margin-bottom: 15px;
        }

        .form-section h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-color);
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-container {
                flex-direction: column;
            }
            
            .search-container input,
            .search-container select {
                min-width: 100%;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 5px;
            }
            
            .student-form {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 5% auto;
                padding: 15px;
                width: 98%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
            <p>Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ GitHub - ØªØ­ÙˆÙŠÙ„ Excel Ø¥Ù„Ù‰ JSON ØªÙ„Ù‚Ø§Ø¦ÙŠ</p>
        </div>

        <!-- Ù‚Ø³Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div id="loginSection" class="section">
            <div class="login-form">
                <h2 style="margin-bottom: 30px; color: #2c3e50;">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
                
                <div class="input-group">
                    <input type="text" id="teacherId" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¹Ù„Ù…..." autocomplete="off" value="ameen">
                </div>

                <div class="connection-status" id="connectionStatus">
                    â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                </div>

                <button class="btn btn-success" id="loginBtn" disabled>ğŸ”— Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„</button>
                <button class="btn btn-warning" id="retryBtn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
            </div>
        </div>

        <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div id="mainSection" class="section hidden">
            <div class="controls">
                <button class="btn btn-logout" id="logoutBtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                <div style="color: #2c3e50; font-weight: bold;">
                    <span>Ø§Ù„Ù…Ø¹Ù„Ù…: </span>
                    <span id="currentTeacher"></span>
                    <span> | Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨: </span>
                    <span id="studentsCount">0</span>
                </div>
            </div>

            <div id="teacherInfo" class="teacher-info hidden">
                <h3>ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…</h3>
                <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª loaded Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† GitHub</p>
            </div>

            <!-- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© -->
            <div id="searchContainer" class="search-container hidden">
                <input type="text" id="searchInput" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯...">
                <select id="classFilter">
                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>
                </select>
                <button class="btn" id="exportBtn" style="background: linear-gradient(135deg, #27ae60, #229954);">
                    ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>

            <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div id="statsContainer"></div>

            <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Barcode</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                            <th>Ø§Ù„Ø´Ø¹Ø¨Ø©</th>
                            <th>Ù…ÙˆØ§Ø¸Ø¨Ø© 1</th>
                            <th>Ø´ÙÙ‡ÙŠ 1</th>
                            <th>ÙˆØ§Ø¬Ø¨Ø§Øª 1</th>
                            <th>ØªØ­Ø±ÙŠØ±ÙŠ 1</th>
                            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 1</th>
                            <th>Ù…Ø­ØµÙ„Ø© 1</th>
                            <th>Ù…ÙˆØ§Ø¸Ø¨Ø© 2</th>
                            <th>Ø´ÙÙ‡ÙŠ 2</th>
                            <th>ÙˆØ§Ø¬Ø¨Ø§Øª 2</th>
                            <th>ØªØ­Ø±ÙŠØ±ÙŠ 2</th>
                            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 2</th>
                            <th>Ù…Ø­ØµÙ„Ø© 2</th>
                            <th>Ù…ÙˆØ§Ø¸Ø¨Ø© 3</th>
                            <th>ÙˆØ§Ø¬Ø¨Ø§Øª 3</th>
                            <th>Ø´ÙÙ‡ÙŠ 3</th>
                            <th>ØªØ­Ø±ÙŠØ±ÙŠ 3</th>
                            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 3</th>
                            <th>Ù…Ø­ØµÙ„Ø© 3</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <tr>
                            <td colspan="23" style="text-align: center; color: #666; padding: 40px;">
                                â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
        <div id="loading" class="loading hidden">
            â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
        </div>

        <!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨: <span id="currentStudentName"></span></h3>
                <form id="studentForm" class="student-form">
                    <input type="hidden" id="editStudentId">
                    
                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„ -->
                    <div class="form-section">
                        <h4>ğŸ“˜ Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance1">Ù…ÙˆØ§Ø¸Ø¨Ø© 1:</label>
                        <input type="number" id="editAttendance1" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editOral1">Ø´ÙÙ‡ÙŠ 1:</label>
                        <input type="number" id="editOral1" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editHomework1">ÙˆØ§Ø¬Ø¨Ø§Øª 1:</label>
                        <input type="number" id="editHomework1" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editWritten1">ØªØ­Ø±ÙŠØ±ÙŠ 1:</label>
                        <input type="number" id="editWritten1" min="0" max="20" step="0.1">
                    </div>

                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                    <div class="form-section">
                        <h4>ğŸ“— Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance2">Ù…ÙˆØ§Ø¸Ø¨Ø© 2:</label>
                        <input type="number" id="editAttendance2" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editOral2">Ø´ÙÙ‡ÙŠ 2:</label>
                        <input type="number" id="editOral2" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editHomework2">ÙˆØ§Ø¬Ø¨Ø§Øª 2:</label>
                        <input type="number" id="editHomework2" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editWritten2">ØªØ­Ø±ÙŠØ±ÙŠ 2:</label>
                        <input type="number" id="editWritten2" min="0" max="20" step="0.1">
                    </div>

                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø« -->
                    <div class="form-section">
                        <h4>ğŸ“™ Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance3">Ù…ÙˆØ§Ø¸Ø¨Ø© 3:</label>
                        <input type="number" id="editAttendance3" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editHomework3">ÙˆØ§Ø¬Ø¨Ø§Øª 3:</label>
                        <input type="number" id="editHomework3" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editOral3">Ø´ÙÙ‡ÙŠ 3:</label>
                        <input type="number" id="editOral3" min="0" max="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editWritten3">ØªØ­Ø±ÙŠØ±ÙŠ 3:</label>
                        <input type="number" id="editWritten3" min="0" max="20" step="0.1">
                    </div>

                    <div class="form-section">
                        <button type="submit" class="btn btn-success">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                        <button type="button" id="cancelEditBtn" class="btn btn-danger">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // ========== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub ==========
        const GITHUB_EXCEL_URL = 'https://raw.githubusercontent.com/ameen-algmady/grades1/main/students.xlsx';
        
        // ========== Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø§Ù„ØµÙØ­Ø© ==========
        const loginSection = document.getElementById('loginSection');
        const mainSection = document.getElementById('mainSection');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const retryBtn = document.getElementById('retryBtn');
        const teacherIdInput = document.getElementById('teacherId');
        const studentsTableBody = document.getElementById('studentsTableBody');
        const loadingDiv = document.getElementById('loading');
        const teacherInfoDiv = document.getElementById('teacherInfo');
        const currentTeacherSpan = document.getElementById('currentTeacher');
        const studentsCountSpan = document.getElementById('studentsCount');
        const exportBtn = document.getElementById('exportBtn');
        const connectionStatus = document.getElementById('connectionStatus');
        const editModal = document.getElementById('editModal');
        const closeModal = document.querySelector('.close-modal');
        const studentForm = document.getElementById('studentForm');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const currentStudentName = document.getElementById('currentStudentName');

        // ========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ==========
        let currentTeacherId = '';
        let filteredStudents = [];
        let allStudents = [];
        let currentEditStudent = null;

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ ==========
        function validateTeacherId(teacherId) {
            return /^[a-zA-Z0-9_\-]+$/.test(teacherId) && teacherId.length >= 3;
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ==========
        function showLoading(show, message = 'â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...') {
            if (show) {
                loadingDiv.classList.remove('hidden');
                loadingDiv.innerHTML = `<p>${message}</p>`;
            } else {
                loadingDiv.classList.add('hidden');
            }
        }

        function showError(message) {
            loadingDiv.classList.remove('hidden');
            loadingDiv.innerHTML = `
                <div style="color: red; text-align: center; padding: 20px;">
                    <p>âŒ ${message}</p>
                    <button onclick="hideError()" style="margin: 5px; padding: 5px 10px; background: #e74c3c; color: white; border: none; border-radius: 3px; cursor: pointer;">
                        Ø¥ØºÙ„Ø§Ù‚
                    </button>
                </div>
            `;
        }

        function hideError() {
            loadingDiv.classList.add('hidden');
        }

        function showSuccess(message) {
            loadingDiv.classList.remove('hidden');
            loadingDiv.innerHTML = `<p style="color: green;">âœ… ${message}</p>`;
            setTimeout(() => loadingDiv.classList.add('hidden'), 3000);
        }

        function updateConnectionStatus(message, type = 'info') {
            const colors = {
                info: '#fff3cd',
                success: '#d4edda',
                error: '#f8d7da'
            };
            
            const borderColors = {
                info: '#ffeaa7',
                success: '#c3e6cb',
                error: '#f5c6cb'
            };
            
            connectionStatus.innerHTML = message;
            connectionStatus.style.background = colors[type] || colors.info;
            connectionStatus.style.borderColor = borderColors[type] || borderColors.info;
        }

        // ========== Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub ÙˆØªØ­ÙˆÙŠÙ„ Excel ==========
        async function loadExcelFromGitHub() {
            updateConnectionStatus('ğŸŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub...', 'info');
            
            try {
                const response = await fetch(GITHUB_EXCEL_URL);
                
                if (!response.ok) {
                    throw new Error(`ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ${response.status} ${response.statusText}`);
                }
                
                updateConnectionStatus('ğŸ“ ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ - Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù...', 'info');
                
                const arrayBuffer = await response.arrayBuffer();
                
                updateConnectionStatus('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Excel Ø¥Ù„Ù‰ JSON...', 'info');
                
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const excelData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                
                const processed = processExcelData(excelData);
                allStudents = processed;
                
                updateConnectionStatus(`âœ… ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ - ${allStudents.length} Ø·Ø§Ù„Ø¨`, 'success');
                loginBtn.disabled = false;
                loginBtn.style.background = 'linear-gradient(135deg, #27ae60, #229954)';
                
                console.log('ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', allStudents);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„:', error);
                updateConnectionStatus(`
                    âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù† GitHub
                    <br><br>
                    <strong>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:</strong> ${error.message}
                `, 'error');
                
                loginBtn.disabled = true;
            }
        }

        // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª Excel ==========
        function processExcelData(excelData) {
            if (!excelData || excelData.length < 2) {
                throw new Error('Ø§Ù„Ù…Ù„Ù Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©');
            }

            const headers = excelData[0];
            const students = [];
            
            console.log('ğŸ” Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:', headers);

            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±Ù (Ø§Ù„Ø¹Ù…ÙˆØ¯ X)
            const teacherIdColumn = 23; // Ø§Ù„Ø¹Ù…ÙˆØ¯ X (24-1)
            const idColumn = 0; // ID
            const barcodeColumn = 1; // Barcode
            const nameColumn = 2; // Ø§Ù„Ø§Ø³Ù…
            const classColumn = 3; // Ø§Ù„Ø´Ø¹Ø¨Ø©
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
            const attendance1Column = 4;
            const oral1Column = 5;
            const homework1Column = 6;
            const written1Column = 7;
            const total1Column = 8;
            const result1Column = 9;
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
            const attendance2Column = 10;
            const oral2Column = 11;
            const homework2Column = 12;
            const written2Column = 13;
            const total2Column = 14;
            const result2Column = 15;
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
            const attendance3Column = 16;
            const homework3Column = 17;
            const oral3Column = 18;
            const written3Column = 19;
            const total3Column = 20;
            const result3Column = 21;

            for (let i = 1; i < excelData.length; i++) {
                const row = excelData[i];
                if (row.length === 0) continue;

                const student = {
                    id: row[idColumn] || `STD${i}`,
                    barcode: row[barcodeColumn] || '',
                    name: row[nameColumn] || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…',
                    class: row[classColumn] || '---',
                    teacherId: (row[teacherIdColumn] || '').toString().trim(),
                    
                    // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
                    attendance1: formatGrade(row[attendance1Column]),
                    oral1: formatGrade(row[oral1Column]),
                    homework1: formatGrade(row[homework1Column]),
                    written1: formatGrade(row[written1Column]),
                    total1: formatGrade(row[total1Column]),
                    result1: formatGrade(row[result1Column]),
                    
                    // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
                    attendance2: formatGrade(row[attendance2Column]),
                    oral2: formatGrade(row[oral2Column]),
                    homework2: formatGrade(row[homework2Column]),
                    written2: formatGrade(row[written2Column]),
                    total2: formatGrade(row[total2Column]),
                    result2: formatGrade(row[result2Column]),
                    
                    // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
                    attendance3: formatGrade(row[attendance3Column]),
                    homework3: formatGrade(row[homework3Column]),
                    oral3: formatGrade(row[oral3Column]),
                    written3: formatGrade(row[written3Column]),
                    total3: formatGrade(row[total3Column]),
                    result3: formatGrade(row[result3Column]),
                    
                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
                    fullData: row
                };

                if (student.teacherId) {
                    students.push(student);
                }
            }

            return students;
        }

        function formatGrade(value) {
            if (value === null || value === undefined || value === '') return '0';
            if (typeof value === 'number') return value.toString();
            return value.toString().trim();
        }

        // ========== ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ù„Ù… ==========
        function filterStudentsByTeacher() {
            if (!allStudents || allStudents.length === 0) {
                filteredStudents = [];
                return;
            }

            filteredStudents = allStudents.filter(student => 
                student.teacherId === currentTeacherId
            );

            console.log(`ğŸ‘¨â€ğŸ« ØªÙ… ØªØµÙÙŠØ© ${filteredStudents.length} Ø·Ø§Ù„Ø¨ Ù„Ù„Ù…Ø¹Ù„Ù… ${currentTeacherId}`);
        }

        // ========== Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© ==========
        function addSearchFunctionality() {
            const searchContainer = document.getElementById('searchContainer');
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø¹Ø¨
            updateClassFilter();
            
            document.getElementById('searchInput').addEventListener('input', filterStudents);
            document.getElementById('classFilter').addEventListener('change', filterStudents);
        }

        function updateClassFilter() {
            const classFilter = document.getElementById('classFilter');
            const classes = [...new Set(filteredStudents.map(student => student.class).filter(c => c))];
            
            classFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>';
            classes.forEach(className => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                classFilter.appendChild(option);
            });
        }

        function filterStudents() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedClass = document.getElementById('classFilter').value;
            
            let filtered = allStudents.filter(student => 
                student.teacherId === currentTeacherId
            );
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø«
            if (searchTerm) {
                filtered = filtered.filter(student => 
                    student.name.toLowerCase().includes(searchTerm) ||
                    student.barcode.toLowerCase().includes(searchTerm)
                );
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ ØªØµÙÙŠØ© Ø§Ù„Ø´Ø¹Ø¨Ø©
            if (selectedClass) {
                filtered = filtered.filter(student => student.class === selectedClass);
            }
            
            filteredStudents = filtered;
            renderStudentsTable();
            displayStatistics(filteredStudents);
        }

        // ========== Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ==========
        function renderStudentsTable() {
            studentsTableBody.innerHTML = '';
            
            if (filteredStudents.length === 0) {
                studentsTableBody.innerHTML = `
                    <tr>
                        <td colspan="23" style="text-align: center; color: #666; padding: 40px;">
                            ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶ Ù„Ù„Ù…Ø¹Ù„Ù… ${currentTeacherId}
                        </td>
                    </tr>
                `;
                return;
            }
            
            filteredStudents.forEach((student) => {
                const row = document.createElement('tr');
                
                function getResultClass(result) {
                    const value = parseFloat(result) || 0;
                    if (value >= 4.5) return 'result-excellent';
                    if (value >= 3.5) return 'result-good';
                    if (value >= 2.5) return 'result-average';
                    return 'result-poor';
                }

                const result1Class = getResultClass(student.result1);
                const result2Class = getResultClass(student.result2);
                const result3Class = getResultClass(student.result3);
                
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.barcode}</td>
                    <td>
                        <span class="student-name" onclick="openEditModal('${student.id}')">
                            ${student.name}
                        </span>
                    </td>
                    <td>${student.class}</td>
                    <td>${student.attendance1}</td>
                    <td>${student.oral1}</td>
                    <td>${student.homework1}</td>
                    <td>${student.written1}</td>
                    <td><strong>${student.total1}</strong></td>
                    <td class="result-cell ${result1Class}">${student.result1}</td>
                    <td>${student.attendance2}</td>
                    <td>${student.oral2}</td>
                    <td>${student.homework2}</td>
                    <td>${student.written2}</td>
                    <td><strong>${student.total2}</strong></td>
                    <td class="result-cell ${result2Class}">${student.result2}</td>
                    <td>${student.attendance3}</td>
                    <td>${student.homework3}</td>
                    <td>${student.oral3}</td>
                    <td>${student.written3}</td>
                    <td><strong>${student.total3}</strong></td>
                    <td class="result-cell ${result3Class}">${student.result3}</td>
                    <td>
                        <button class="edit-btn" onclick="openEditModal('${student.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                    </td>
                `;
                studentsTableBody.appendChild(row);
            });
        }

        // ========== Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ==========
        function openEditModal(studentId) {
            currentEditStudent = filteredStudents.find(s => s.id === studentId);
            if (!currentEditStudent) return;
            
            currentStudentName.textContent = currentEditStudent.name;
            document.getElementById('editStudentId').value = currentEditStudent.id;
            
            // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
            document.getElementById('editAttendance1').value = currentEditStudent.attendance1;
            document.getElementById('editOral1').value = currentEditStudent.oral1;
            document.getElementById('editHomework1').value = currentEditStudent.homework1;
            document.getElementById('editWritten1').value = currentEditStudent.written1;
            
            // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
            document.getElementById('editAttendance2').value = currentEditStudent.attendance2;
            document.getElementById('editOral2').value = currentEditStudent.oral2;
            document.getElementById('editHomework2').value = currentEditStudent.homework2;
            document.getElementById('editWritten2').value = currentEditStudent.written2;
            
            // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
            document.getElementById('editAttendance3').value = currentEditStudent.attendance3;
            document.getElementById('editHomework3').value = currentEditStudent.homework3;
            document.getElementById('editOral3').value = currentEditStudent.oral3;
            document.getElementById('editWritten3').value = currentEditStudent.written3;
            
            editModal.style.display = 'block';
        }

        function closeEditModal() {
            editModal.style.display = 'none';
            studentForm.reset();
            currentEditStudent = null;
        }

        // ========== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ==========
        function calculateStatistics(students) {
            const stats = {
                total: students.length,
                excellent: 0,
                good: 0,
                average: 0,
                poor: 0
            };
            
            students.forEach(student => {
                const avg = (parseFloat(student.result1 || 0) + 
                            parseFloat(student.result2 || 0) + 
                            parseFloat(student.result3 || 0)) / 3;
                
                if (avg >= 4.5) stats.excellent++;
                else if (avg >= 3.5) stats.good++;
                else if (avg >= 2.5) stats.average++;
                else stats.poor++;
            });
            
            return stats;
        }

        function displayStatistics(students) {
            const stats = calculateStatistics(students);
            const statsHTML = `
                <div class="stats-container">
                    <h4 style="margin: 0 0 15px 0; color: #2c3e50;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h4>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div style="color: #27ae60; font-weight: bold; font-size: 18px;">${stats.excellent}</div>
                            <div style="font-size: 12px; color: #666;">Ù…Ù…ØªØ§Ø²</div>
                        </div>
                        <div class="stat-item">
                            <div style="color: #3498db; font-weight: bold; font-size: 18px;">${stats.good}</div>
                            <div style="font-size: 12px; color: #666;">Ø¬ÙŠØ¯</div>
                        </div>
                        <div class="stat-item">
                            <div style="color: #f39c12; font-weight: bold; font-size: 18px;">${stats.average}</div>
                            <div style="font-size: 12px; color: #666;">Ù…ØªÙˆØ³Ø·</div>
                        </div>
                        <div class="stat-item">
                            <div style="color: #e74c3c; font-weight: bold; font-size: 18px;">${stats.poor}</div>
                            <div style="font-size: 12px; color: #666;">Ø¶Ø¹ÙŠÙ</div>
                        </div>
                        <div class="stat-item" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white;">
                            <div style="font-weight: bold; font-size: 18px;">${stats.total}</div>
                            <div style="font-size: 12px;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</div>
                        </div>
                    </div>
                </div>
            `;
            
            const existingStats = document.getElementById('statsContainer');
            if (existingStats) {
                existingStats.innerHTML = statsHTML;
            } else {
                const statsContainer = document.createElement('div');
                statsContainer.id = 'statsContainer';
                statsContainer.innerHTML = statsHTML;
                teacherInfoDiv.parentNode.insertBefore(statsContainer, teacherInfoDiv.nextSibling);
            }
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==========
        function loadStudentsForTeacher() {
            if (!allStudents || allStudents.length === 0) {
                showError('âŒ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯');
                return;
            }
            
            showLoading(true);
            
            try {
                filterStudentsByTeacher();
                
                renderStudentsTable();
                displayStatistics(filteredStudents);
                studentsCountSpan.textContent = filteredStudents.length;
                currentTeacherSpan.textContent = currentTeacherId;
                teacherInfoDiv.classList.remove('hidden');
                
                addSearchFunctionality();
                document.getElementById('searchContainer').classList.remove('hidden');
                
                showLoading(false);
                showSuccess(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${filteredStudents.length} Ø·Ø§Ù„Ø¨`);
                
            } catch (error) {
                showLoading(false);
                showError('Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: ' + error.message);
            }
        }

        // ========== Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ==========
        loginBtn.addEventListener('click', async function() {
            const teacherId = teacherIdInput.value.trim();
            if (!teacherId) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¹Ø±Ù');
                return;
            }
            
            if (!validateTeacherId(teacherId)) {
                alert('Ø§Ù„Ù…Ø¹Ø±Ù ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù ÙˆØ£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· ÙˆÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                return;
            }
            
            currentTeacherId = teacherId;
            loginSection.classList.add('hidden');
            mainSection.classList.remove('hidden');
            logoutBtn.classList.remove('hidden');
            
            loadStudentsForTeacher();
        });

        retryBtn.addEventListener('click', function() {
            loadExcelFromGitHub();
        });

        logoutBtn.addEventListener('click', function() {
            currentTeacherId = '';
            loginSection.classList.remove('hidden');
            mainSection.classList.add('hidden');
            logoutBtn.classList.add('hidden');
            teacherIdInput.value = '';
            teacherInfoDiv.classList.add('hidden');
        });

        exportBtn.addEventListener('click', function() {
            if (filteredStudents.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            const jsonData = JSON.stringify(filteredStudents, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ø·Ù„Ø§Ø¨_${currentTeacherId}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            showSuccess('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        });

        closeModal.addEventListener('click', closeEditModal);
        cancelEditBtn.addEventListener('click', closeEditModal);

        studentForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentEditStudent) return;
            
            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
            currentEditStudent.attendance1 = document.getElementById('editAttendance1').value;
            currentEditStudent.oral1 = document.getElementById('editOral1').value;
            currentEditStudent.homework1 = document.getElementById('editHomework1').value;
            currentEditStudent.written1 = document.getElementById('editWritten1').value;
            
            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
            currentEditStudent.attendance2 = document.getElementById('editAttendance2').value;
            currentEditStudent.oral2 = document.getElementById('editOral2').value;
            currentEditStudent.homework2 = document.getElementById('editHomework2').value;
            currentEditStudent.written2 = document.getElementById('editWritten2').value;
            
            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
            currentEditStudent.attendance3 = document.getElementById('editAttendance3').value;
            currentEditStudent.homework3 = document.getElementById('editHomework3').value;
            currentEditStudent.oral3 = document.getElementById('editOral3').value;
            currentEditStudent.written3 = document.getElementById('editWritten3').value;
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ ÙˆØ§Ù„Ù…Ø­ØµÙ„Ø§Øª
            currentEditStudent.total1 = calculateTotal(currentEditStudent, 1);
            currentEditStudent.result1 = calculateResult(currentEditStudent, 1);
            currentEditStudent.total2 = calculateTotal(currentEditStudent, 2);
            currentEditStudent.result2 = calculateResult(currentEditStudent, 2);
            currentEditStudent.total3 = calculateTotal(currentEditStudent, 3);
            currentEditStudent.result3 = calculateResult(currentEditStudent, 3);
            
            renderStudentsTable();
            displayStatistics(filteredStudents);
            closeEditModal();
            showSuccess('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        });

        function calculateTotal(student, term) {
            const attendance = parseFloat(student[`attendance${term}`]) || 0;
            const oral = parseFloat(student[`oral${term}`]) || 0;
            const homework = parseFloat(student[`homework${term}`]) || 0;
            const written = parseFloat(student[`written${term}`]) || 0;
            
            return (attendance + oral + homework + written).toString();
        }

        function calculateResult(student, term) {
            const total = parseFloat(calculateTotal(student, term));
            return (total / 5).toFixed(1); // Ø§Ù„Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ 5 Ù„Ø£Ù† Ø§Ù„Ø¯Ø±Ø¬Ø© Ù…Ù† 20
        }

        // ========== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ==========
        document.addEventListener('DOMContentLoaded', function() {
            teacherIdInput.value = 'ameen';
            loadExcelFromGitHub();
        });

        console.log('ğŸš€ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø² - Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ GitHub');
    </script>
</body>
</html>